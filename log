# shellcheck shell=bash

# author:       Li Junhao           edwin.jh.lee@gmail.com    edwinjhlee.github.io
# maintainer:   Li Junhao

## Features:
## 1. Color text: 采用Formatter分离的方式
## 2. 

log.color(){
    local data="$(cat -)"
    printf "\033[1;31m%s\033[0m" "$data"
}

log.new(){
    oo.create_new_function log "$@"
}

log.make(){
    local name="${1:?Provide name}"

    eval "
        $name.info(){ 
            log.info.color \"\$@\"
        }
        $name.debug(){ 
            log.debug.color \"\$@\"
        }
        $name.error(){ 
            log.error.color \"\$@\"
        }
        alias $name.panic='
            log.panic.color \"\$@\";
            return \$1 2>/dev/null || exit 1
        '
    "
}

log.info(){
    printf "INF: %s\n" "$*" >&2
}

log.info.color(){
    printf "\033[1;34mINF: %s\033[0m\n" "$*" >&2
}

log.debug(){
    printf "DBG: %s\n" "$*" >&2
    
}

log.debug.color(){
    printf "\033[0;32mDBG: %s\033[0m\n" "$*" >&2
}

log.error(){
    printf "ERR: %s\n" "$*" >&2
}

log.error.color(){
    printf "\033[1;31mERR: %s\033[0m\n" "$*" >&2
}

log.panic(){
    printf "PANIC: %s\n" "$@" >&2
}

log.panic.color(){
    printf "\033[1;31mPANIC: %s\033[0m\n" "$*" >&2
}

# shellcheck disable=SC2142
alias @panic='
    printf "%s\n" "$*" >&2
    return 1 2>/dev/null || exit 1
'
